<?php/** * Copyright (c) 2006-2024 LogicalDOC * WebSites: www.logicaldoc.com *  * No bytes were intentionally harmed during the development of this application. * * This program is free software; you can redistribute it and/or modify * it under the terms of the GNU General Public License as published by * the Free Software Foundation; either version 2 of the License, or * (at your option) any later version. * * This program is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the * GNU General Public License for more details. * * You should have received a copy of the GNU General Public License along * with this program; if not, write to the Free Software Foundation, Inc., * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. */// no direct accessdefined( '_JEXEC' ) or die( 'Restricted access' ); require_once (JPATH_COMPONENT . '/IconSelector.php');?><script type="text/javascript">    $(document).ready(function() {                        $(document).ready(function() {            var iDisplayLength = <?= $this->rowConfiguration->showEntries ?>;            var icon = <?= $this->rowConfiguration->icon ?>;            var size = <?= $this->rowConfiguration->size ?>;            var updateDate = <?= $this->rowConfiguration->updateDate ?>;            var author = <?= $this->rowConfiguration->author ?>;            var version = <?= $this->rowConfiguration->version ?>;            var iconValor = false;            var sizeValor = false;            var updateDateValor = false;            var authorValor = false;            var versionValor = false;            if(icon == 1){                iconValor = true;            }            if(size === 1){                sizeValor = true;            }            if(updateDate == 1){                updateDateValor = true;             }            if(author == 1){                authorValor = true;            }            if(version == 1){                versionValor = true;            }                 $('#tablaSearch').dataTable({                "bJQueryUI": true,                "sPaginationType": "full_numbers",                                "iDisplayLength": iDisplayLength,                "bFilter":false,                "aoColumns": [                    { "bSortable": false,"bSearchable": false,"bVisible":iconValor},                    { "bSortable": true ,"bVisible":true},                    { "bSortable": true ,"bVisible":sizeValor,                        "mRender": function(size, type, full) {                            if (type == 'display') {                                if (size === '0') {return '0 KB';}                                if (size == 0) {return ' ';}                                var sizek = Math.floor( size / 1024 ).toFixed(0) * 1;                                return sizek.toLocaleString() + ' KB';                            }                            return size;                        }                    },                	{ "bSortable": true, "bVisible": updateDateValor, 						"mRender": function(date, type, full) {										if (type == 'display') {											var mydt = new Date(date);											return mydt.toLocaleDateString() + " " + mydt.toLocaleTimeString();								  		}		                              return date;		                           }      				},                    { "bSortable": true ,"bVisible":authorValor},                    { "bSortable": false,"bVisible":versionValor }                ],                "aaSorting": [[ 0, "asc" ]],                "oLanguage": {                    "sProcessing": "<?= JText::_('COM_LOGICALDOC_PLEASE_WAIT') ?>",                    "sLengthMenu": "<?= JText::_('COM_LOGICALDOC_SHOW') ?>_MENU_ <?= JText::_('COM_LOGICALDOC_ENTRIES') ?>",                    "sZeroRecords": "<?= JText::_('COM_LOGICALDOC_NOTHING_FOUND_SORRY') ?>",                    "sInfo": "<?= JText::_('COM_LOGICALDOC_SHOWING') ?>_START_ <?= JText::_('COM_LOGICALDOC_TO') ?> _END_ <?= JText::_('COM_LOGICALDOC_OF') ?> _TOTAL_ <?= JText::_('COM_LOGICALDOC_ENTRIES') ?>",                    "sInfoEmpty": "<?= JText::_('COM_LOGICALDOC_SHOWING') ?> 0 <?= JText::_('COM_LOGICALDOC_TO') ?> 0 <?= JText::_('COM_LOGICALDOC_OF') ?> 0 <?= JText::_('COM_LOGICALDOC_ENTRIES') ?>",                    "sInfoFiltered": "(<?= JText::_('COM_LOGICALDOC_FILTERED_FROM') ?> _MAX_ <?= JText::_('COM_LOGICALDOC_TOTAL_ENTRIES') ?>)",                    "sInfoPostFix": "",                    "sSearch": "<?= JText::_('COM_LOGICALDOC_SEARCH') ?>",                    "sUrl": "",                    "oPaginate": {                        "sFirst":    "<?= JText::_('COM_LOGICALDOC_FIRST') ?>",                        "sPrevious": "<?= JText::_('COM_LOGICALDOC_PREVIOUS') ?>",                        "sNext":     "<?= JText::_('COM_LOGICALDOC_NEXT') ?>",                        "sLast":     "<?= JText::_('COM_LOGICALDOC_LAST') ?>"                    }                }            });        });            });</script><style>    #advanced{        margin-top:10px;        margin-bottom:10px;    }</style><?phpfunction printFolder($folder) { ?>    <tr>        <td align="center">            <?php if ($folder->hasChildren == 1) { ?>                <img src="components/com_logicaldoc/assets/images/menuitem_childs.png" />             <?php } else {                ?>                <img src="components/com_logicaldoc/assets/images/menuitem_empty.png" />               <?php } ?>                    </td>        <td>            <a href="index.php?option=com_logicaldoc&view=explorer&task=folder&path=<?php echo $folder->path; ?>" >                <?php                	echo substr($folder->path, strrpos($folder->path, '/') + 1);                ?>            </a>        </td>        <td>        </td>        <td>                        <?php            $time = strtotime($folder->created);            echo date('d/m/Y h:i:s', $time);            ?>        </td>        <td>            <?php echo $folder->author ?>        </td>        <td>                   </td>     </tr>    <?php}function printDocument($document, $rowConfiguration) {    ?>    <tr>        <td>            <img style="text-align: center" src="components/com_logicaldoc/assets/mimes/<?php echo IconSelector::selectIcon($document->type); ?>" />        </td>        <td>            <?php            $download_url = JRoute::_('index.php?option=com_logicaldoc&view=search&task=download&id='.$rowConfiguration->idConfiguration.'&documentID='.$document->id, false);            ?>            <a href="<?php echo $download_url;?>">                <?php echo $document->fileName; ?>            </a>        </td>        <td style="white-space: nowrap; text-align: right;"><?php echo $document->fileSize; ?></td>        <td>            <?php			$ymd = DateTime::createFromFormat('Y-m-d H:i:s O', $document->date);			//echo $ymd->format('d/m/Y H:i:s');			echo $ymd->format('c');            ?>        </td>        <td>            <?php echo $document->creator; ?>        </td>        <td>            <?php echo $document->fileVersion; ?>        </td>    </tr>    <?php}function redondear($numero, $decimales) {    $factor = pow(10, $decimales);    return (round($numero * $factor) / $factor);}if ($this->error == 0) {    ?>        <div id="advanced">        <?php require_once ('form.php'); ?>    </div>    <table id="tablaSearch" width="100%" class="display" cellpadding="0" cellspacing="0" border="0">        <thead>            <tr>                <th> </th>                <th><?= JText::_('COM_LOGICALDOC_NAME') ?></th>                <th><?= JText::_('COM_LOGICALDOC_SIZE') ?></th>                <th><?= JText::_('COM_LOGICALDOC_UPDATE_DATE') ?></th>                <th><?= JText::_('COM_LOGICALDOC_AUTHOR') ?></th>                <th><?= JText::_('COM_LOGICALDOC_VERSION') ?></th>            </tr>        </thead>        <tbody>            <?php            if (!empty($this->resultArray)) {                if (is_array($this->resultArray)) {                    foreach ($this->resultArray as $result) {			printDocument($result, $this->rowConfiguration);                    }                } else {			printDocument($this->resultArray, $this->rowConfiguration);                }            }            ?>        </tbody>    </table><?php } else { ?>        <h2><?= JText::_('COM_LOGICALDOC_ERROR_THE_CONFIGURATION_IS_NOT_CORRECT_PLEASE_CHECK_YOUR_LOGICALDOC_CONFIGURATION_TO_CONNECTO_TO') ?>.</h2>    <?php}?>